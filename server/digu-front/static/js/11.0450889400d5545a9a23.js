webpackJsonp([11],{"5s2O":function(e,t){},WXbu:function(e,t){},a2kl:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,r=o("bOdI"),s=o.n(r),n=o("woOf"),a=o.n(n),l=o("mvHQ"),u=o.n(l),d=o("GeYD"),c=o("u4Bf"),p={name:"basetable",components:{draggable:o.n(c).a},data:function(){return{tableLoading:!0,select_word:"",itemActive:"unclassified",height:500,tableHeight:300,cur_page:1,repositoryData:[],removeTypeName:"",moveItemName:"",moveItemId:"",moveItemNameTitle:"",multipleSelection:[],oldRepositoryMenu:[],moveItemsVisible:!1,removeTypeVisible:!1,delVisible:!1,activeName:"first",moveRepositoryMenu:[],addGroupIndex:1,pagination:{show:!0,total:0,pageIndex:1,pageSize:20},repositoryMenu:[],creatFAQVForm:{questionContent:"",questionContentOther:[{name:"相似问题",value:""}],creatFAQOptions:[],answerContent:""},isNewFile:!1,atchKnow:{excelPathTip:"",errorMessage:"",excelPath:"",filePath:"",filePathNew:"",excelPathTipNew:"",excelPathNew:""},upload_img_index:-1,correctArry:[],atchKnowRules:{filePath:[{required:!0,message:"请上传知识问答Excel数据！",trigger:"change"}]},listOfPageData:[],isSubCollapse:!1,typeListData:[],addGroupVisible:!1,addGroupForm:{},addGroupFormRules:{groupName:[{required:!0,message:"输入知识库名称",trigger:"blur"}]},modifyGroupVisible:!1,modifyGroupForm:{},modifyGroupFormRules:{groupName:[{required:!0,message:"输入知识库名称",trigger:"blur"}]},knowledgeTypeListCurrent:"",delItemsVisible:!1,tabItem:"a",groupId:"",searchType:"",queryKey:""}},created:function(){var e=this,t=document.documentElement.clientHeight;this.tableHeight=t-260,d.a.$emit("contentTop",!0),d.a.$on("knowledgeSteps",function(t){t&&1==t&&(e.tabItem="a")});var o=localStorage.getItem("repositoryListIndex");null!=o&&"unclassified"!=o&&(this.itemActive=o),this.getrepositoryMenu()},computed:{},methods:(i={handleConfig:function(e,t){},handleCurrentChange:function(e){},getrepositoryMenu:function(){var e=this;$.get(this.$baseUrl+"knowledge/queryKnowledgeTypeList.json").then(function(t){if("0000"==t.resultMessageEnum)if(t.returnObject&&t.returnObject.length){var o=e.$route.params.id,i=t.returnObject;e.itemActive>=0&&t.returnObject[e.itemActive]&&(o=t.returnObject[e.itemActive].id),i.forEach(function(e,t){e.isEdit=!1,e.show=!1}),e.repositoryMenu=i,e.$store.dispatch("setRepositoryConfigData",i),e.$router.history.current.fullPath.indexOf("/sub/")<0&&e.$router.push("/repository/set/"+o)}else e.$router.push("/repository/set/unclassified"),e.repositoryMenu=[];else e.$message.error(t.errorInfoList[0].errorMessage)})},modifyKnowledgeType:function(e,t){var o=this,i=this;if(e.newAdd){var r={typeName:e.typeName};$.post(this.$baseUrl+"knowledge/addKnowledgeType.json",u()(r)).then(function(e){"0000"==e.resultMessageEnum?(i.repositoryMenu[t].newAdd=!1,i.repositoryMenu[t].show=!1,i.repositoryMenu[t].isEdit=!1,i.repositoryMenu[t].id=e.returnObject):i.$message.error(e.errorInfoList[0].errorMessage)})}else{var s={id:e.id,typeName:e.typeName};$.post(this.$baseUrl+"knowledge/modifyKnowledgeType.json",u()(s)).then(function(e){"0000"==e.resultMessageEnum?(o.repositoryMenu[t].show=!1,o.repositoryMenu[t].isEdit=!1):o.$message.error(e.errorInfoList[0].errorMessage)})}},addGroup:function(){var e={newAdd:!0,isEdit:!0,show:!0,typeName:"新增分类"+this.addGroupIndex};this.repositoryMenu.push(e),this.addGroupIndex=this.addGroupIndex+1},removeKnowledgeType:function(e,t){this.removeTypeName=e.typeName,this.removeTypeId=e.id,this.removeTypeIndex=t,this.removeTypeVisible=!0},removeGroupEnter:function(){var e=this,t={typeId:this.removeTypeId};$.post(this.$baseUrl+"knowledge/removeKnowledgeType.json?"+$.param(t)).then(function(t){"0000"==t.resultMessageEnum?(e.repositoryMenu.splice(e.removeTypeIndex,1),e.removeTypeVisible=!1):e.$message.error(t.errorInfoList[0].errorMessage)})},draggableStart:function(){this.oldRepositoryMenu=this.repositoryMenu},draggableEnd:function(e){var t=this,o=[];this.repositoryMenu.forEach(function(e){o.push(e.id)}),this.sortKnowledgeType(o).then(function(o){t.itemActive==e.oldIndex?t.itemActive=e.newIndex:t.queryKnowledgeGroupListOfPage(t.repositoryMenu[t.itemActive],t.itemActive)})},sortKnowledgeType:function(e){var t=this,o=$.Deferred();return $.post(this.$baseUrl+"knowledge/sortKnowledgeType.json?",u()(e)).then(function(e){"0000"==e.resultMessageEnum?o.resolve():(t.repositoryMenu=t.oldRepositoryMenu,t.$message.error(e.errorInfoList[0].errorMessage))}),o},sortChange:function(){},handleSelectionChange:function(){},queryKnowledgeGroupListOfPage:function(e,t,o){this.itemActive=""==e||void 0===t?"unclassified":t,localStorage.setItem("repositoryListIndex",this.itemActive),o&&"handleClick"==o&&(this.multipleSelection=[],this.$router.push("/repository/set/"+(e&&e.id||"unclassified")))},handleAddGroup:function(){var e=this,t={groupName:this.addGroupForm.groupName,knowledgeTypeId:this.activeGroupId,knowledgeTypeName:this.activeGroupName};this.$refs.addGroupForm.validate(function(o){if(!o)return console.log("error submit!!"),!1;$.post(e.$baseUrl+"knowledge/addKnowledgeGroup.json?",u()(t)).then(function(t){"0000"==t.resultMessageEnum?e.addGroupVisible=!1:e.$message.error(t.errorInfoList[0].errorMessage)})})},removeKnowledgeGroup:function(){var e=this,t={groupName:this.addGroupForm.groupName,knowledgeTypeId:this.activeGroupId};$.post(this.$baseUrl+"knowledge/removeKnowledgeGroup.json?",u()(t)).then(function(t){"0000"==t.resultMessageEnum||e.$message.error(t.errorInfoList[0].errorMessage)})},handleModifyGroup:function(e,t){this.modifyGroupForm.groupName=t.groupName,this.modifyGroupForm.id=t.id,this.modifyGroupVisible=!0},modifyKnowledgeGroup:function(){var e=this,t={groupName:this.modifyGroupForm.groupName,id:this.modifyGroupForm.id};this.$refs.modifyGroupForm.validate(function(o){$.post(e.$baseUrl+"knowledge/modifyKnowledgeGroup.json?",u()(t)).then(function(t){"0000"==t.resultMessageEnum?e.modifyGroupVisible=!1:e.$message.error(t.errorInfoList[0].errorMessage)})})},search:function(){this.cur_page=1,this.pagination.total=0,"a"==this.tabItem||"b"==this.tabItem&&(this.queryKey=this.select_word)},searchChange:function(e){e||"a"==this.tabItem||(this.queryKey="")},addQuestion:function(){var e={name:"",value:"",key:Date.now()};this.creatFAQVForm.questionContentOther.length<2?this.creatFAQVForm.questionContentOther.push(e):this.creatFAQVForm.questionContentOther.splice(1,0,e)},moveKnowledgeGroup:function(){var e=this,t=[];this.multipleSelection.forEach(function(e){t.push(e.id)});var o={newTypeId:this.moveItemId,knowledgeGroupIdList:t};$.post(this.$baseUrl+"knowledge/moveKnowledgeGroup.json",u()(o)).then(function(t){"0000"==t.resultMessageEnum&&(e.multipleSelection=[],e.$message.success("移动成功！"),e.moveItemsVisible=!1)})},moveKnowledgeItem:function(){var e=this,t=[];this.multipleSelection.forEach(function(e){t.push(e.id)});var o={newGroupId:this.moveItemId,knowledgeItemIdList:t};$.post(this.$baseUrl+"knowledge/moveKnowledgeItem.json",u()(o)).then(function(t){"0000"==t.resultMessageEnum&&(e.multipleSelection=[],e.$message.success("移动成功！"),e.moveItemsVisible=!1)})},editRepositoryMenu:function(e,t){var o=this;this.repositoryMenu.forEach(function(e,i){var r=o.repositoryMenu[t],s=o.repositoryMenu[i];i==t?(r.show=!0,r.isEdit=!0):s.show&&(s.show=!1,s.isEdit=!1,s.typeName=o.oldRepositoryMenuItem.typeName,s.id=o.oldRepositoryMenuItem.id)}),this.oldRepositoryMenuItem=a()({},e)},cancelEdit:function(e,t){e.newAdd?(this.repositoryMenu.splice(t,1),this.addGroupIndex--):(this.repositoryMenu[t].show=!1,this.repositoryMenu[t].isEdit=!1,this.repositoryMenu[t].typeName=this.oldRepositoryMenuItem.typeName,this.repositoryMenu[t].id=this.oldRepositoryMenuItem.id)}},s()(i,"handleSelectionChange",function(e){this.multipleSelection=e}),s()(i,"deletItem",function(e){this.delVisible=!0,this.delActiveItemId=e.id}),s()(i,"handleDelItems",function(){this.multipleSelection.length?this.delItemsVisible=!0:this.$message.error("请选择要删除的FAQ!")}),s()(i,"removeKnowledgeGroupList",function(){var e=this,t=[];this.multipleSelection.forEach(function(e){t.push(e.id)}),$.post(this.$baseUrl+"knowledge/removeKnowledgeGroupList.json",u()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.delItemsVisible=!1,e.multipleSelection=[]):e.$message.error(t.errorInfoList[0].errorMessage)})}),s()(i,"publishKnowledgeGroup",function(e,t){var o=this;t.id;$.post(this.$baseUrl+"knowledge/publishKnowledgeGroup.json?groupId="+t.id).then(function(t){"0000"==t.resultMessageEnum?(o.listOfPageData[e].itemUpdateFlag=0,o.$message.success("发布成功")):o.$message.error(t.errorInfoList[0].errorMessage)})}),s()(i,"removeKnowledgeItemList",function(e){var t=this,o=[];e&&"single"==e?o.push(this.delActiveItemId):this.multipleSelection.forEach(function(e){o.push(e.id)}),$.post(this.$baseUrl+"knowledge/removeKnowledgeItemList.json",u()(o)).then(function(o){"0000"==o.resultMessageEnum?"single"==e?(t.delVisible=!1,t.delActiveItemId=""):(t.delItemsVisible=!1,t.multipleSelection=[]):t.$message.error(o.errorInfoList[0].errorMessage)})}),s()(i,"downloadExcelTemplate",function(){window.location.href=this.$baseUrl+"common/downloadExcelTemplate.html?excelTemplateType=2"}),s()(i,"checkAnnexFile",function(){var e=this,t={excelTemplateType:2};this.upload_img_index>-1?t.filePath=this.correctArry[this.upload_img_index].excelPath:t.filePath=this.atchKnow.excelPath,$.post(this.$baseUrl+"common/checkAnnexFile.json",u()(t)).then(function(t){if("0000"==t.resultMessageEnum){var o={};if(t.returnObject.correctFlag)o={nextUpload:!1,correctFilePath:t.returnObject.correctFilePath};else{var i=t.returnObject.rowNumber-t.returnObject.exceptionRowNumber+"条上传成功，剩余"+t.returnObject.exceptionRowNumber+"条上传失败！";e.correctArry.length>0?e.correctArry[e.upload_img_index].errorMessage=i:e.atchKnow.errorMessage=i;var r=(~~(1e5*Math.random())).toString();o={nextUpload:!0,correctFilePath:t.returnObject.correctFilePath,errorFilePath:e.$baseUrl+"file/downloadFile.html?filePath="+t.returnObject.errorFilePath,id:"file_"+r}}e.correctArry.push(o),e.upload_img_index++}else e.$message.error(t.errorInfoList[0].errorMessage)})}),s()(i,"uploadAnnexFile",function(e){var t=this,o=new FormData;o.append("sourceType",102),o.append("file",$("#"+e)[0].files[0]),$.ajax({url:this.$baseUrl+"common/uploadAnnexFile.json",type:"POST",cache:!1,data:o,dataType:"json",headers:{"Content-Type":"multipart/form-data"},processData:!1,contentType:!1,async:!1}).done(function(e){"0000"==e.resultMessageEnum?(t.upload_img_index>-1?(t.correctArry[t.upload_img_index].excelPathTip=t.correctArry[t.upload_img_index].filePath,t.correctArry[t.upload_img_index].excelPath=e.returnObject):(t.atchKnow.excelPathTip=t.atchKnow.filePath,t.atchKnow.excelPath=e.returnObject),t.checkAnnexFile()):t.$message.error("上传失败！")}).fail(function(e){})}),s()(i,"saveBatchKnowledgeItem",function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var o={id:t.activeGroupId};if(t.correctArry.length){var i=[];t.correctArry.forEach(function(e){e.correctFilePath&&i.push(e.correctFilePath)}),o.correctFilePathList=i}else o.filePath=t.atchKnow.excelPath;$.post(t.$baseUrl+"knowledge/saveBatchKnowledgeItem.json",u()(o)).then(function(e){"0000"==e.resultMessageEnum||t.$message.error(e.errorInfoList[0].errorMessage)})})}),s()(i,"handleManageReposClick",function(){d.a.$emit("manangeReposVisible")}),i),watch:{addGroupVisible:function(e){e||this.$refs.addGroupForm.resetFields()},modifyGroupVisible:function(e){e||this.$refs.modifyGroupForm.resetFields()}},destroyed:function(){}},m={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{class:{"sub-collapse":e.isSubCollapse}},[o("div",{staticClass:"rep-box-slider"},[o("div",{staticClass:"repository-menu-box"},[o("div",{staticClass:"repository-menu-top"},[o("a",{staticClass:"header-button",on:{click:e.handleManageReposClick}},[o("i",{staticClass:"el-icon-folder-opened"}),e._v("知识库模版\n        ")]),e._v(" "),o("div",{staticClass:"header-title"},[e._v("\n          知识库行业分类\n          "),o("i",{staticClass:"iconfont icon-ico_add",on:{click:e.addGroup}})])]),e._v(" "),o("div",{staticClass:"repository-menu"},[o("div",{staticClass:"repository-menu-item",class:{active:"unclassified"==e.itemActive}},[o("span",{staticClass:"groupName",on:{click:function(t){return e.queryKnowledgeGroupListOfPage("","","handleClick")}}},[e._v("未分类")])]),e._v(" "),o("draggable",{on:{end:e.draggableEnd,start:e.draggableStart},model:{value:e.repositoryMenu,callback:function(t){e.repositoryMenu=t},expression:"repositoryMenu"}},[o("transition-group",e._l(e.repositoryMenu,function(t,i){return o("div",{key:t.id||"add-"+i,staticClass:"repository-menu-item",class:{active:i==e.itemActive,edit:t.isEdit}},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],staticClass:"repository-menu-input-box"},[1!=t.type&&2!=t.type?o("el-input",{model:{value:t.typeName,callback:function(o){e.$set(t,"typeName",o)},expression:"item.typeName"}}):e._e()],1),e._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!t.show,expression:"!item.show"}],staticClass:"groupName",on:{click:function(o){return e.queryKnowledgeGroupListOfPage(t,i,"handleClick")}}},[e._v(e._s(t.typeName))]),e._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],staticClass:"repository-icon-box edit-box"},[o("i",{staticClass:"el-icon-check",on:{click:function(o){return e.modifyKnowledgeType(t,i)}}}),e._v(" "),o("i",{staticClass:"el-icon-close",on:{click:function(o){return e.cancelEdit(t,i)}}})]),e._v(" "),1!=t.groupFlag&&0!=t.groupFlag?o("div",{staticClass:"repository-icon-box hover-box"},[o("i",{staticClass:"iconfont icon-ico_move-sort"}),e._v(" "),o("i",{staticClass:"iconfont icon-ico_edit-content",on:{click:function(o){return e.editRepositoryMenu(t,i)}}}),e._v(" "),o("i",{staticClass:"iconfont icon-ico_delete",on:{click:function(o){return e.removeKnowledgeType(t,i)}}})]):e._e()])}),0)],1)],1)]),e._v(" "),o("span",{staticClass:"slider-fold",on:{click:function(t){e.isSubCollapse=!e.isSubCollapse}}})]),e._v(" "),o("div",{staticClass:"table"},[o("div",{staticClass:"repository-page"},[o("router-view")],1),e._v(" "),o("el-dialog",{staticClass:"creat-faq-dialog",attrs:{title:"新增知识库",visible:e.addGroupVisible,width:"600px"},on:{"update:visible":function(t){e.addGroupVisible=t}}},[o("el-form",{ref:"addGroupForm",attrs:{model:e.addGroupForm,"label-width":"114px",rules:e.addGroupFormRules}},[o("el-form-item",{attrs:{label:"知识库名称",prop:"groupName",placeholder:"输入知识库名称"}},[o("el-input",{model:{value:e.addGroupForm.groupName,callback:function(t){e.$set(e.addGroupForm,"groupName",t)},expression:"addGroupForm.groupName"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.addGroupVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.handleAddGroup}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{staticClass:"creat-faq-dialog",attrs:{title:"修改名称",visible:e.modifyGroupVisible,width:"600px"},on:{"update:visible":function(t){e.modifyGroupVisible=t}}},[o("el-form",{ref:"modifyGroupForm",attrs:{model:e.modifyGroupForm,"label-width":"114px",rules:e.modifyGroupFormRules}},[o("el-form-item",{attrs:{label:"知识库名称",prop:"groupName",placeholder:"输入知识库名称"}},[o("el-input",{model:{value:e.modifyGroupForm.groupName,callback:function(t){e.$set(e.modifyGroupForm,"groupName",t)},expression:"modifyGroupForm.groupName"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.modifyGroupVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.modifyKnowledgeGroup}},[e._v("确 定")])],1)],1),e._v(" "),o("el-dialog",{attrs:{title:"删除知识库",visible:e.delItemsVisible,width:"400px"},on:{"update:visible":function(t){e.delItemsVisible=t}}},[o("div",[e._v("您确定要删除已选择的知识库吗？如果知识库正在使用中，删除后将不能在已关联的话术中正常使用。")]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.delItemsVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.removeKnowledgeGroupList}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{title:e.moveItemNameTitle,visible:e.moveItemsVisible,width:"400px"},on:{"update:visible":function(t){e.moveItemsVisible=t}}},[o("div",[e._v("您确定要移动此"+e._s(e.multipleSelection.length)+"条知识库到"+e._s(e.moveItemName)+"吗？")]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.moveItemsVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.moveKnowledgeGroup}},[e._v("确 定")])],1)]),e._v(" "),o("el-dialog",{attrs:{title:"删除确认",visible:e.removeTypeVisible,width:"400px"},on:{"update:visible":function(t){e.removeTypeVisible=t}}},[o("div",[e._v("\n        您确定要删除知识库分类“"+e._s(e.removeTypeName)+"”吗？\n        "),o("br"),e._v("相关知识库将不会被删除，继续保留在“未分类”中\n      ")]),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.removeTypeVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.removeGroupEnter}},[e._v("确 定")])],1)])],1)])},staticRenderFns:[]};var h=o("VU/8")(p,m,!1,function(e){o("WXbu"),o("5s2O")},"data-v-5bc936c5",null);t.default=h.exports}});