webpackJsonp([13],{Jgmt:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o("mvHQ"),i=o.n(r),s=(o("DHmE"),o("nasK")),n=o("fMZB"),a={data:function(){return{page_show_level:"1",pagination:{show:!0,total:0,pageIndex:1,pageSize:10},cur_page:1,cur_type_page:1,memberId:"",knowledgeTypeId:"",queryKey:"",knowledgeTypeList:[],listOfPageData:[],tableHeight:500,sortList:[],selectGroupList:[],ddQueryKey:"",knowledgeData:[],ddPagination:{show:!0,total:0,pageIndex:1,pageSize:10},groupId:"",cur_dd_page:1,videoVisible:!1,viewSource:"",viewPlaying:!1,dialogCopyVisible:!1,copyForm:{indestryId:"",groupName:"",groupId:""},industryList:[],ddItemList:[]}},created:function(){this.memberId=this.$route.params.id,this.queryKnowledgeTypeList(),this.queryKnowledgeGroupListOfPage()},components:{wVideo:s.a,wSound:n.a},methods:{goGengal:function(){this.$router.push("/repository/2")},tableRowClassName:function(e){var t=e.row;e.rowIndex;if(t.isEdit&&1*t.isEdit>0)return"row-not-edit"},onSearch:function(){this.cur_type_page=1,this.queryKnowledgeGroupListOfPage()},queryKnowledgeTypeList:function(){var e=this,t={MemberId:this.memberId};$.get(this.$baseUrl+"services/knowledge/queryKnowledgeTypeList.json",$.param(t)).then(function(t){if("0000"==t.resultMessageEnum){var o=[];for(var r in o.push({id:"DEL1",typeName:"全部"}),t.returnObject)o.push(t.returnObject[r]);e.knowledgeTypeList=o}else e.$message.error(t.errorInfoList[0].errorMessage)})},menuItemClick:function(e){this.cur_type_page=1,"DEL1"!=e.index?this.knowledgeTypeId=e.index:this.knowledgeTypeId="",this.queryKnowledgeGroupListOfPage()},sortChange:function(e){var t=!0;t="ascending"==e.order,this.sortList=[{propertyName:e.prop,ascendingFlag:t}],this.queryKnowledgeGroupListOfPage()},handleSelectionChange:function(e){for(var t in this.selectGroupList=[],e)this.selectGroupList.push(e[t].id)},queryKnowledgeGroupListOfPage:function(){var e=this,t={currentPage:this.cur_type_page-1,pageSize:this.pagination.pageSize,templateType:2};""!=this.knowledgeTypeId&&(t.knowledgeTypeId=this.knowledgeTypeId),""!=this.queryKey&&(t.groupName=this.queryKey),this.sortList&&(t.sortList=this.sortList),$.post(this.$baseUrl+"services/knowledge/queryKnowledgeGroupListOfPage.json",i()(t)).then(function(t){"0000"==t.resultMessageEnum?(console.log(t),e.listOfPageData=t.returnObject.recordList,e.pagination.total=t.returnObject.totalNumber):e.$message.error(t.errorInfoList[0].errorMessage)})},handleKnowLedgeChange:function(e){this.cur_type_page=e,this.queryKnowledgeGroupListOfPage()},handleLook:function(e,t){this.selectGroupList=[],this.page_show_level=2,this.groupId=t.id,this.queryKnowledgeItemList()},handleCopy:function(e,t){this.copyForm={},this.copyForm.groupName=t.groupName,this.copyForm.groupId=t.id,this.dialogCopyVisible=!0,this.queryAllIndustryList()},onDDSearch:function(){this.cur_dd_page=1,this.queryKnowledgeItemList()},ddReturn:function(){this.page_show_level=1,this.ddItemList=[]},ddSortChange:function(e){console.log(e)},ddHandleSelectionChange:function(e){this.ddItemList=[];for(var t in e)this.ddItemList.push(e[t].id);console.log(this.ddItemList)},handleCurrentChange:function(e){this.cur_dd_page=e,this.queryKnowledgeItemList()},queryKnowledgeItemList:function(){var e=this,t={groupId:this.groupId,searchType:2,currentPage:this.cur_dd_page-1,pageSize:this.ddPagination.pageSize};""!=this.ddQueryKey&&(t.queryKey=this.ddQueryKey),$.post(this.$baseUrl+"services/knowledge/queryKnowledgeItemList.json",i()(t)).then(function(t){if("0000"==t.resultMessageEnum){var o=t.returnObject&&t.returnObject.recordList;if(o){var r=[];o.forEach(function(e,t){var o="";try{o=JSON.parse(e.answerContent)}catch(t){o=e.answerContent}"[object Array]"==Object.prototype.toString.call(o)&&o.length?o.forEach(function(t,o){var i={questionContent:0==o?e.questionContent:"",answerContent:t.text,editTime:0==o?e.editTime:"",editor:0==o?e.editor:"",editorId:e.editorId,id:e.id,soundPath:t.soundPath,soundDuration:t.soundDuration,soundSize:t.soundSize,isEdit:o};r.push(i)}):r.push(e)}),e.knowledgeData=r}e.ddPagination.total=t.returnObject.totalNumber}else self.$message.error(t.errorInfoList[0].errorMessage)})},handleVideoAnswer:function(){var e=this;this.videoVisible=!0,this.$nextTick(function(){e.viewSource=e.creatFAQVForm.answerContent[e.currentIndex].soundPath})},handleVideo:function(e){var t=this;this.videoVisible=!0,this.$nextTick(function(){t.viewSource=e.soundPath})},handleLookHdd:function(e){this.$router.push("/repository/view/"+e)},queryAllIndustryList:function(){var e=this;$.get(this.$baseUrl+"services/intention/queryAllIndustryList.json").then(function(t){"0000"==t.resultMessageEnum&&(t.returnObject&&t.returnObject.length?(e.industryList=t.returnObject,console.log(e.industryList)):self.$message.error(t.errorInfoList[0].errorMessage))})},saveCopy:function(){var e=this,t={};for(var o in t.indestryId=this.copyForm.indestryId,this.industryList)this.industryList[o].id==this.copyForm.indestryId&&(t.indestryName=this.industryList[o].industryName);t.groupId=this.copyForm.groupId,this.$refs.copyForm.validate(function(o){if(!o)return!1;$.post(e.$baseUrl+"services/knowledge/copyKnoledgeFromMemberToManager.json",i()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.dialogCopyVisible=!1,e.$message.success("复制成功")):e.$message.error(t.errorInfoList[0].errorMessage)})})},createExportKnowledgeItemExcelFile:function(){var e=this;$.post(this.$baseUrl+"services/knowledge/createExportKnowledgeItemExcelFile.json",i()(this.ddItemList)).then(function(t){"0000"==t.resultMessageEnum?(window.location.href=e.$baseUrl+"services/file/downloadFile.html?filePath="+t.returnObject.filePath,e.$message.success("下载成功！")):self.$message.error(t.errorInfoList[0].errorMessage)})},createExportKnowledgeItemExcelFileByGroupIds:function(){var e=this;$.post(this.$baseUrl+"services/knowledge/createExportKnowledgeItemExcelFileByGroupIds.json",i()(this.selectGroupList)).then(function(t){"0000"==t.resultMessageEnum?(window.location.href=e.$baseUrl+"services/file/downloadFile.html?filePath="+t.returnObject.filePath,e.$message.success("下载成功！")):self.$message.error(t.errorInfoList[0].errorMessage)})}},watch:{}},l={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"container-admin"},[o("div",{staticClass:"admin-page"},[o("el-row",[o("el-col",{attrs:{span:20}},[o("el-breadcrumb",{attrs:{separator:"/"}},[o("el-breadcrumb-item",[e._v("管理中心")]),e._v(" "),o("el-breadcrumb-item",[e._v("知识库管理")]),e._v(" "),o("el-breadcrumb-item",[e._v("用户知识库")]),e._v(" "),o("el-breadcrumb-item",[e._v("查看用户知识库")]),e._v(" "),e.page_show_level>1?o("el-breadcrumb-item",[e._v("问答对列表")]):e._e(),e._v(" "),e.page_show_level>2?o("el-breadcrumb-item",[e._v("查看问答对")]):e._e()],1)],1),e._v(" "),o("el-col",{attrs:{span:4}},[o("i",{staticStyle:{"padding-right":"10px",float:"right","padding-bottom":"10px"}},[1==e.page_show_level?o("el-button",{on:{click:e.goGengal}},[e._v("返回")]):e._e(),e._v(" "),2==e.page_show_level?o("el-button",{on:{click:e.ddReturn}},[e._v("返回")]):e._e(),e._v(" "),3==e.page_show_level?o("el-button",[e._v("返回")]):e._e()],1)])],1)],1),e._v(" "),o("div",{staticClass:"admin-body"},[o("el-tabs"),e._v(" "),1==e.page_show_level?o("el-row",[o("el-col",[o("el-form",{staticClass:"w-form-inline",attrs:{inline:!0}},[o("el-form-item",{attrs:{label:"关键词："}},[o("el-input",{attrs:{clearable:"",placeholder:"知识库名称"},nativeOn:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.onSearch(t):null}},model:{value:e.queryKey,callback:function(t){e.queryKey=t},expression:"queryKey"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("搜索")])],1)],1)],1)],1):e._e(),e._v(" "),1==e.page_show_level?o("el-row",[o("el-row",[o("el-button",{attrs:{disabled:!e.selectGroupList.length},on:{click:e.createExportKnowledgeItemExcelFileByGroupIds}},[e._v("导出")])],1)],1):e._e(),e._v(" "),1==e.page_show_level?o("el-row",{staticClass:"success"},[o("el-col",{attrs:{span:5}},[o("div",{staticClass:"repository-menu-box"},[o("div",{staticClass:"repository-menu-top"},[e._v("知识库分类")]),e._v(" "),o("div",{staticClass:"repository-menu"},[o("el-menu",{staticClass:"repository-menu",attrs:{"default-active":"DEL1"}},e._l(e.knowledgeTypeList,function(t){return o("el-menu-item",{key:t.id,staticClass:"repository-menu-item",attrs:{index:t.id},on:{click:e.menuItemClick}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v(e._s(t.typeName))])])}),1)],1)])]),e._v(" "),o("el-col",{attrs:{span:19}},[o("el-table",{attrs:{stripe:"",data:e.listOfPageData,height:e.tableHeight},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),o("el-table-column",{attrs:{prop:"groupName",label:"知识库名称"}}),e._v(" "),o("el-table-column",{attrs:{width:"200",sortable:"",prop:"editTime",label:"更新时间"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.handleLook(t.$index,t.row)}}},[e._v("查看")]),e._v(" "),o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.handleCopy(t.$index,t.row)}}},[e._v("复制")])]}}],null,!1,1297628391)})],1),e._v(" "),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:e.pagination.total,"page-size":e.pagination.pageSize},on:{"current-change":e.handleKnowLedgeChange}})],1)],1)],1):e._e(),e._v(" "),2==e.page_show_level?o("el-row",[o("el-col",[o("el-form",{staticClass:"w-form-inline",attrs:{inline:!0}},[o("el-form-item",{attrs:{label:"关键词："}},[o("el-input",{attrs:{clearable:"",placeholder:"主问题/相似问题/回答"},nativeOn:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.onDDSearch(t):null}},model:{value:e.ddQueryKey,callback:function(t){e.ddQueryKey=t},expression:"ddQueryKey"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.onDDSearch}},[e._v("搜索")])],1)],1)],1)],1):e._e(),e._v(" "),2==e.page_show_level?o("el-row",[o("el-row",[o("el-button",{attrs:{disabled:!e.ddItemList.length},on:{click:e.createExportKnowledgeItemExcelFile}},[e._v("导出")])],1)],1):e._e(),e._v(" "),2==e.page_show_level?o("el-row",[o("el-col",[o("el-table",{attrs:{stripe:"",data:e.knowledgeData,"row-class-name":e.tableRowClassName,height:e.tableHeight},on:{"sort-change":e.ddSortChange,"selection-change":e.ddHandleSelectionChange}},[o("el-table-column",{staticClass:"isEdit",attrs:{type:"selection",width:"55"}}),e._v(" "),o("el-table-column",{attrs:{prop:"questionContent",label:"主问题"}}),e._v(" "),o("el-table-column",{attrs:{prop:"questionContentOther",label:"相似问题"}}),e._v(" "),o("el-table-column",{attrs:{prop:"answerContent",label:"回答"}}),e._v(" "),o("el-table-column",{attrs:{width:"140",sortable:"",prop:"editTime",label:"更新时间"}}),e._v(" "),o("el-table-column",{attrs:{width:"100",prop:"editor",label:"操作人"}}),e._v(" "),o("el-table-column",{attrs:{width:"60",label:"音频"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",{directives:[{name:"show",rawName:"v-show",value:t.row.soundPath,expression:"scope.row.soundPath"}],staticClass:"w_icon_play w_icon_pause",on:{click:function(o){return e.handleVideo(t.row)}}})]}}],null,!1,478815062)}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){return e.handleLookHdd(t.row.id)}}},[e._v("查看")])]}}],null,!1,1050805305)})],1),e._v(" "),o("div",{staticClass:"pagination"},[o("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:e.ddPagination.total,"page-size":e.ddPagination.pageSize},on:{"current-change":e.handleCurrentChange}})],1)],1)],1):e._e(),e._v(" "),o("el-dialog",{attrs:{title:"音频",visible:e.videoVisible,width:"600px"},on:{"update:visible":function(t){e.videoVisible=t}}},[o("w-video",{attrs:{source:e.viewSource,playing:e.viewPlaying}})],1),e._v(" "),o("el-dialog",{attrs:{title:"复制知识库到通用知识库",visible:e.dialogCopyVisible,width:"30%"},on:{"update:visible":function(t){e.dialogCopyVisible=t}}},[o("div",[o("el-form",{ref:"copyForm",attrs:{model:e.copyForm,"label-width":"18%"}},[o("el-form-item",{attrs:{label:"知识库名称:"}},[o("el-input",{attrs:{readonly:""},model:{value:e.copyForm.groupName,callback:function(t){e.$set(e.copyForm,"groupName",t)},expression:"copyForm.groupName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"行业领域",prop:"indestryId",rules:[{required:!0,message:"请选择行业领域"}]}},[o("el-select",{attrs:{placeholder:"行业领域"},model:{value:e.copyForm.indestryId,callback:function(t){e.$set(e.copyForm,"indestryId",t)},expression:"copyForm.indestryId"}},e._l(e.industryList,function(e){return o("el-option",{key:e.id,attrs:{label:e.industryName,value:e.id}})}),1)],1)],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogCopyVisible=!1}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:e.saveCopy}},[e._v("确 定")])],1)])],1)])},staticRenderFns:[]};var d=o("VU/8")(a,l,!1,function(e){o("TQhf")},"data-v-ed1fa85e",null);t.default=d.exports},TQhf:function(e,t){}});