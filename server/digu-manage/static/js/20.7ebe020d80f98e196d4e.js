webpackJsonp([20],{QR8D:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("mvHQ"),i=r.n(a),s=r("DHmE"),o=r("WfbR"),n={name:"hotEntry",data:function(){return{cur_page:1,pagination:{show:!0,total:0,pageIndex:1,pageSize:10},dictionaryId:"",isIndustry:"1",dictionaryType:1,dictionaryName:"",queryKey:"",multipleSelection:[],deleteDisable:!0,deleteVisible:!1,createVisible:!1,batchUploadVisible:!1,createForm:{tableData:[],createRules:{targetWord:[{required:!0,message:"目标词不能为空！",trigger:"blur"}]}},oldTargetWord:"",oldSourceWord:"",errorVisible:!1,errorTitle:"",errorText:"",fileName:"",importFilePath:"",fullScreenLoading:null,searchForm:{queryKey:"",memberIds:[],allManager:!1},managerList:[]}},props:{},components:{},created:function(){this.dictionaryId=this.$route.params.id,this.isIndustry=this.$route.params.isIndustry,"1"==this.isIndustry?this.dictionaryType=1:this.dictionaryType=3,s.a.$emit("contentTop",!1),this.userInfo=JSON.parse(localStorage.getItem("USER_INFO"));var e=document.documentElement.clientHeight;this.height=e-330,this.handleQueryEntryList(),this.queryAllManager()},computed:{},methods:{handleBack:function(){"1"==this.isIndustry?this.$router.push("/hotword?type=1"):this.$router.push("/hotword?type=2&active=1")},handleQueryEntryList:function(){var e=this,t=$.extend({},{currentPage:this.cur_page-1,pageSize:this.pagination.pageSize,dictionaryId:this.dictionaryId});this.searchForm.queryKey&&(t.queryKey=this.searchForm.queryKey),this.sortList&&(t.sortList=this.sortList),this.searchForm.allManager?t.memberIds=[]:t.memberIds=this.searchForm.memberIds,$.post(this.$baseUrl+"services/hotWord/queryEntryList.json",i()(t)).then(function(t){"0000"===t.resultMessageEnum?(e.createForm.tableData=t.returnObject.recordList,e.pagination.total=t.returnObject.totalNumber):e.$message.error(t.errorInfoList[0].errorMessage)})},handleCreateEntry:function(){for(var e=0;e<this.createForm.tableData.length;e++){var t=this.createForm.tableData[e];if(t.isEdit||t.isAdd)return this.errorVisible=!0,this.errorTitle="提醒",void(this.errorText="请先保存正在编辑/新增的热词！")}this.createForm.tableData.unshift({sourceWord:"",targetWord:"",isAdd:!0})},handleSelectionChange:function(e){this.multipleSelection=e,this.deleteDisable=!(this.multipleSelection.length>0)},handleSelectable:function(e,t){return!e.isAdd},handleSortChange:function(e){var t=!0;t="ascending"==e.order,this.sortList=[{propertyName:e.prop,ascendingFlag:t}],this.handleQueryEntryList()},handleUpdate:function(){var e=this;$.post(this.$baseUrl+"services/hotWord/updateEntry.json?dictionaryId="+this.dictionaryId).then(function(t){"0000"==t.resultMessageEnum?(e.handleQueryEntryList(),e.$message.success("更新成功，词典生效时间请等待2分钟左右！")):e.$message.error(t.errorInfoList[0].errorMessage)})},handleDownloadTemplate:function(){window.location.href=this.$baseUrl+"services/hotWord/downloadTemplate.html"},handleFileChange:function(e){this.fileName=$("#importInput")[0].files[0].name},handleBatchUpload:function(){this.batchUploadVisible=!0,$("#importInput").val(""),this.fileName="",this.errorText=""},handleConfirmBatchUpload:function(){var e=this,t=new FormData;t.append("dictionaryType",this.dictionaryType),t.append("dictionaryId",this.dictionaryId),t.append("file",$("#importInput")[0].files[0]),this.openFullScreenLoading("热词上传中"),$.ajax({url:this.$baseUrl+"services/hotWord/uploadEntryFile.json",type:"POST",cache:!1,data:t,dataType:"json",headers:{"Content-Type":"multipart/form-data"},processData:!1,contentType:!1,async:!0}).done(function(t){if(e.fullScreenLoading.close(),"0000"==t.resultMessageEnum)e.batchUploadVisible=!1,e.$message.success("上传成功！"),e.handleQueryEntryList();else{var r=t.errorInfoList[0].errorMessageEnum;e.errorText="090001"==r||"090002"==r||"090003"==r?t.resultMessage:t.errorInfoList[0].errorMessage}})},handleConfirmDelete:function(){var e=this,t=[];this.multipleSelection.length>0&&this.multipleSelection.forEach(function(e){t.push(e.id)}),$.post(this.$baseUrl+"services/hotWord/removeEntry.json",i()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.deleteVisible=!1,e.handleQueryEntryList(),e.$message.success("删除热词成功！")):e.$message.error(t.errorInfoList[0].errorMessage)})},handleEdit:function(e,t){for(var r=0;r<this.createForm.tableData.length;r++){var a=this.createForm.tableData[r];if(a.isEdit||a.isAdd)return this.errorVisible=!0,this.errorTitle="提醒",void(this.errorText="请先保存正在编辑/新增的热词！")}this.oldTargetWord=t.targetWord,this.oldSourceWord=t.sourceWord,t.isEdit=!0,this.$set(this.createForm.tableData,e,t)},handleCancelEdit:function(e,t){t.isAdd?this.createForm.tableData.splice(e,1):(t.targetWord=this.oldTargetWord,t.sourceWord=this.oldSourceWord,this.oldTargetWord="",this.oldSourceWord="",t.isEdit=!1,this.$set(this.createForm.tableData,e,t))},handleConfirmEdit:function(e,t){var r=this;this.$refs.createForm.validate(function(a){if(!a)return!1;var s={dictionaryType:r.dictionaryType,dictionaryId:r.dictionaryId,dictionaryName:r.dictionaryName,targetWord:t.targetWord,sourceWord:t.sourceWord};t.isAdd?$.post(r.$baseUrl+"services/hotWord/addEntry.json",i()(s)).then(function(e){"0000"==e.resultMessageEnum?(r.createVisible=!1,r.handleQueryEntryList(),r.$message.success("新增热词成功！")):("090001"==e.errorInfoList[0].errorMessageEnum?(r.errorVisible=!0,r.errorTitle="原有词冲突"):"090002"==e.errorInfoList[0].errorMessageEnum?(r.errorVisible=!0,r.errorTitle="原有词冲突"):"090003"==e.errorInfoList[0].errorMessageEnum?(r.errorVisible=!0,r.errorTitle="目标词冲突"):r.$message.error(e.errorInfoList[0].errorMessage),r.errorText=e.resultMessage)}):(s=$.extend(s,{id:t.id,asrId:t.asrId,asrEntryId:t.asrEntryId}),$.post(r.$baseUrl+"services/hotWord/modifyEntry.json",i()(s)).then(function(a){"0000"==a.resultMessageEnum?(r.handleCancelEdit(e,t),r.handleQueryEntryList(),r.$message.success("修改成功！")):("090001"==a.errorInfoList[0].errorMessageEnum?(r.errorVisible=!0,r.errorTitle="原有词冲突"):"090002"==a.errorInfoList[0].errorMessageEnum?(r.errorVisible=!0,r.errorTitle="原有词冲突"):"090003"==a.errorInfoList[0].errorMessageEnum?(r.errorVisible=!0,r.errorTitle="目标词冲突"):r.$message.error(a.errorInfoList[0].errorMessage),r.errorText=a.resultMessage)}))})},handleEntryStatus:function(e,t){return o.a.entryStatus(e.entryStatus)},handleCurrentChange:function(e){this.cur_page=e,this.handleQueryEntryList()},handleSizeChange:function(e){this.pagination.pageSize=e,this.handleQueryEntryList()},handleSearch:function(){if(!this.searchForm.queryKey)return this.$message.error("请输入关键字！"),!1;this.cur_page=1,this.handleQueryEntryList()},searchChange:function(e){e||this.handleQueryEntryList()},openFullScreenLoading:function(e){this.fullScreenLoading=this.$loading({lock:!0,text:e+"...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},queryAllManager:function(){var e=this;$.get(this.$baseUrl+"services/manager/getManagerList.json").then(function(t){"0000"==t.resultMessageEnum?t.returnObject&&t.returnObject.length&&(e.managerList=t.returnObject):e.$message.error(t.errorInfoList[0].errorMessage)})}},destroyed:function(){s.a.$emit("contentTop",!1)},watch:{viewVisible:function(e){e||s.a.$emit("viewPlaying",!0)}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-admin"},[r("div",{staticClass:"admin-page"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[e._v("管理中心")]),e._v(" "),r("el-breadcrumb-item",[e._v("热词管理")]),e._v(" "),"1"===e.isIndustry?r("el-breadcrumb-item",[e._v("行业词典")]):e._e(),e._v(" "),"2"===e.isIndustry?r("el-breadcrumb-item",[e._v("用户词典")]):e._e(),e._v(" "),"2"===e.isIndustry?r("el-breadcrumb-item",[e._v("新建词典")]):e._e(),e._v(" "),r("el-breadcrumb-item",[e._v("编辑词典")])],1),e._v(" "),r("el-button",{staticClass:"back-btn",on:{click:e.handleBack}},[e._v("返回")])],1),e._v(" "),r("div",{staticClass:"admin-body"},[r("div",{staticClass:"speech-tab-pane"},[r("div",[r("el-row",[r("el-form",{ref:"searchForm",staticClass:"demo-form-inline",attrs:{model:e.searchForm,inline:!0}},[r("el-form-item",{attrs:{label:"关键词:",prop:"queryKey"}},[r("el-input",{attrs:{clearable:"",placeholder:"目标词"},on:{change:e.searchChange},model:{value:e.searchForm.queryKey,callback:function(t){e.$set(e.searchForm,"queryKey",t)},expression:"searchForm.queryKey"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"操作人：",prop:"memberIds"}},[r("el-select",{attrs:{clearable:"",multiple:"","collapse-tags":"",disabled:e.searchForm.allManager,placeholder:"请选择"},model:{value:e.searchForm.memberIds,callback:function(t){e.$set(e.searchForm,"memberIds",t)},expression:"searchForm.memberIds"}},e._l(e.managerList,function(e){return r("el-option",{key:e.id,attrs:{label:e.loginName,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{prop:"allManager"}},[r("el-checkbox",{model:{value:e.searchForm.allManager,callback:function(t){e.$set(e.searchForm,"allManager",t)},expression:"searchForm.allManager"}},[e._v("全部")])],1),e._v(" "),r("el-form-item",[r("el-button",{on:{click:function(t){return e.handleReset("searchForm")}}},[e._v("重置")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.handleSearch}},[e._v("搜索")])],1)],1)],1),e._v(" "),r("el-row",{staticStyle:{"padding-bottom":"20px"}},[r("el-col",[r("el-button",{attrs:{type:"primary"},on:{click:e.handleBatchUpload}},[e._v("批量上传")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleCreateEntry}},[e._v("新增热词")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleUpdate}},[e._v("更新热词")]),e._v(" "),r("el-button",{attrs:{disabled:e.deleteDisable,type:"primary"},on:{click:function(t){e.deleteVisible=!0}}},[e._v("删除热词")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleQueryEntryList}},[e._v("刷新")])],1)],1),e._v(" "),r("el-row",{staticStyle:{"padding-bottom":"20px"}},[r("span",{staticClass:"span-select"},[e._v("已选"),r("span",{staticClass:"span-select-count"},[e._v(e._s(e.multipleSelection.length))]),e._v("条")])]),e._v(" "),r("el-row",[r("el-col",[r("el-form",{ref:"createForm",attrs:{inline:!0,rules:e.createForm.createRules,model:e.createForm}},[r("el-table",{staticClass:"table",attrs:{data:e.createForm.tableData,height:e.height,pagination:e.pagination,stripe:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange,"sort-change":e.handleSortChange}},[r("el-table-column",{attrs:{type:"selection",width:"50",align:"center",selectable:e.handleSelectable}}),e._v(" "),r("el-table-column",{attrs:{label:"目标词",prop:"targetWord",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-form-item",{attrs:{prop:"tableData."+t.$index+".targetWord",rules:e.createForm.createRules.targetWord}},[t.row.isEdit||t.row.isAdd?r("el-input",{staticClass:"tb-edit-input-with-border",attrs:{type:"textarea",rows:4,placeholder:"输入目标词"},model:{value:t.row.targetWord,callback:function(r){e.$set(t.row,"targetWord",r)},expression:"scope.row.targetWord"}}):r("el-input",{staticClass:"tb-edit-input",attrs:{type:"textarea",rows:1,readonly:""},model:{value:t.row.targetWord,callback:function(r){e.$set(t.row,"targetWord",r)},expression:"scope.row.targetWord"}})],1)]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"原有词",prop:"sourceWord"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.isEdit||t.row.isAdd?r("el-input",{staticClass:"tb-edit-input-with-border",staticStyle:{width:"85%","margin-bottom":"18px"},attrs:{type:"textarea",rows:4,placeholder:"输入原有词，多个以“|”分隔"},model:{value:t.row.sourceWord,callback:function(r){e.$set(t.row,"sourceWord",r)},expression:"scope.row.sourceWord"}}):r("el-input",{staticClass:"tb-edit-input",attrs:{type:"textarea",rows:1,readonly:""},model:{value:t.row.sourceWord,callback:function(r){e.$set(t.row,"sourceWord",r)},expression:"scope.row.sourceWord"}}),e._v(" "),t.row.isEdit||t.row.isAdd?r("div",{staticStyle:{display:"inline",float:"right"}},[r("i",{staticStyle:{color:"#F04A61","font-style":"normal",cursor:"pointer"},on:{click:function(r){return e.handleCancelEdit(t.$index,t.row)}}},[e._v("取消")]),e._v(" "),r("i",{staticStyle:{color:"#0FD9AC","font-style":"normal",cursor:"pointer"},on:{click:function(r){return e.handleConfirmEdit(t.$index,t.row)}}},[e._v("确定")])]):e._e()]}}])}),e._v(" "),r("el-table-column",{attrs:{sortable:"",prop:"editTime",label:"更新时间",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"editor",label:"操作人",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{label:"发布状态",prop:"entryStatus",formatter:e.handleEntryStatus,width:"80"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",disabled:t.row.isAdd},on:{click:function(r){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")])]}}])})],1)],1)],1)],1),e._v(" "),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total,"page-size":e.pagination.pageSize,"page-sizes":[10,50,100,200]},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])]),e._v(" "),r("el-dialog",{staticClass:"creatDialog",attrs:{visible:e.errorVisible,width:"460px"},on:{"update:visible":function(t){e.errorVisible=t}}},[r("span",{attrs:{slot:"title"},slot:"title"},[r("i",{staticClass:"el-icon-warning"}),e._v(e._s(e.errorTitle)+"\n        ")]),e._v("\n        "+e._s(e.errorText)+"\n        "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.errorVisible=!1}}},[e._v("确 定")])],1)]),e._v(" "),r("el-dialog",{staticClass:"creatDialog",attrs:{title:"批量上传热词",visible:e.batchUploadVisible,width:"460px"},on:{"update:visible":function(t){e.batchUploadVisible=t}}},[r("div",[r("el-row",[r("el-col",{staticClass:"import-pop-file",attrs:{span:3}},[r("i",{staticClass:"el-icon-folder-opened"})]),e._v(" "),r("el-col",{staticClass:"fileCol",attrs:{span:20}},[r("span",{staticClass:"import-tip top"},[e._v(e._s(e.errorText))]),e._v(" "),r("el-input",{attrs:{type:"text",placeholder:"选择本地文件"},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),e._v(" "),r("input",{staticClass:"fileInput",attrs:{type:"file",id:"importInput"},on:{change:e.handleFileChange}}),e._v(" "),r("span",{staticClass:"import-tip"},[e._v("注：请先"),r("a",{attrs:{href:"#"},on:{click:e.handleDownloadTemplate}},[e._v("下载模板")]),e._v("，填写完后，再进行上传，文件大小不能超过5M。")])],1)],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.batchUploadVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmBatchUpload}},[e._v("确 定")])],1)]),e._v(" "),r("el-dialog",{staticClass:"creatDialog",attrs:{visible:e.deleteVisible,width:"460px"},on:{"update:visible":function(t){e.deleteVisible=t}}},[r("span",{attrs:{slot:"title"},slot:"title"},[r("i",{staticClass:"el-icon-question"}),e._v("删除热词\n        ")]),e._v("\n        您确定要删除已选的"+e._s(e.multipleSelection.length)+"个热词吗？如果删除将无法恢复。\n        "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.deleteVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleConfirmDelete}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var c=r("VU/8")(n,l,!1,function(e){r("dLG5")},"data-v-75a3c4bc",null);t.default=c.exports},dLG5:function(e,t){}});