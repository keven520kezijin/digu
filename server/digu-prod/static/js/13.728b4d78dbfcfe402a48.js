webpackJsonp([13],{"8DX+":function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l("mvHQ"),i=l.n(a),n=l("bOdI"),s=l.n(n),r=l("Dd8w"),o=l.n(r),c=l("fZjL"),u=l.n(c),m=l("M4fF"),v=(l("GeYD"),l("uSxg"));var d={model:{prop:"formData",event:"change"},props:{label:String,formData:Object}},b={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("el-form-item",{attrs:{label:e.label}},[l("el-select",{model:{value:e.formData.select,callback:function(t){e.$set(e.formData,"select",t)},expression:"formData.select"}},[l("el-option",{attrs:{label:"不限",value:"unlimited"}}),e._v(" "),l("el-option",{attrs:{label:"自定义",value:"custom"}})],1),e._v(" "),"custom"===e.formData.select?l("el-input-number",{attrs:{"controls-position":"right",min:1,max:1e3},model:{value:e.formData.count,callback:function(t){e.$set(e.formData,"count",t)},expression:"formData.count"}}):e._e(),e._v("\n  次\n")],1)},staticRenderFns:[]};var p=l("VU/8")(d,b,!1,function(e){l("uuXw")},null,null).exports,f=[{label:"当日",value:0},{label:"自定义",value:"custom"},{label:"不限",value:-1}],C={components:{wVideo:v.a,LimitInput:p},data:function(){return{total:null,queryPageCondition:{queryKey:null,currentPage:1,pageSize:10},tableData:[],multipleSelection:[],viewVisible:!1,taskItemResultRecognition:[],transferFlag:null,viewPlaying:!1,viewTableData:[],viewSource:"",showAlert:!0,dialogFormVisible:!1,labelPosition:"right",neoCallLimit:{callLimitLevelA:{select:"custom",count:1},callLimitLevelB:{select:"custom",count:1},callLimitLevelC:{select:"custom",count:1},callLimitLevelD:{select:"custom",count:1},callLimitLevelE:{select:"custom",count:1},callLimitLevelF:{select:"custom",count:1},callLimitLevelO:{select:"custom",count:1}},releaseCycleCustom:{releaseCycleLevelA:0,releaseCycleLevelB:0,releaseCycleLevelC:0,releaseCycleLevelD:0,releaseCycleLevelE:0,releaseCycleLevelF:0,releaseCycleLevelO:0},releaseCycleForm:{releaseCycleLevelA:0,releaseCycleLevelB:0,releaseCycleLevelC:0,releaseCycleLevelD:0,releaseCycleLevelE:0,releaseCycleLevelF:0,releaseCycleLevelO:0},releaseCycle:{releaseCycleLevelA:{title:"意图等级A",options:f},releaseCycleLevelB:{title:"意图等级B",options:f},releaseCycleLevelC:{title:"意图等级C",options:f},releaseCycleLevelD:{title:"意图等级D",options:f},releaseCycleLevelE:{title:"意图等级E",options:f},releaseCycleLevelF:{title:"意图等级F",options:f},releaseCycleLevelO:{title:"无意图等级",options:f}},id:""}},created:function(){this.queryAntiHarassmentNumberList(),this.queryTaskConfig()},computed:{formatedCallLimit:function(){var e=this;return u()(this.neoCallLimit).reduce(function(t,l){var a=e.neoCallLimit[l];return o()({},t,s()({},l,"unlimited"===a.select?-1:a.count))},{})}},methods:{submit:function(){var e=this,t=((()=>{try{JSON.parse(localStorage.getItem("USER_INFO"))}catch(e){return{}}})(),u()(this.releaseCycleForm).reduce(function(t,l){return"custom"===e.releaseCycleForm[l]?(t[l]=e.releaseCycleCustom[l],t):(t[l]=e.releaseCycleForm[l],t)},{})),l=i()(o()({id:this.id},this.formatedCallLimit,t));$.post(this.$baseUrl+"task/saveOrUpdateTaskConfig.json",l).then(function(t){"0000"==t.resultMessageEnum?(e.dialogFormVisible=!1,e.queryTaskConfig()):e.$message.error(t.errorInfoList[0].errorMessage)})},handleHarass:function(){this.dialogFormVisible=!0},handleSelectionChange:function(e){this.multipleSelection=e},queryAntiHarassmentNumberList:function(){var e=this;$.post(this.$baseUrl+"task/queryAntiHarassmentNumberList.json",i()(this.queryPageCondition)).then(function(t){if("0000"==t.resultMessageEnum){var l=t.returnObject;e.total=l.totalNumber,e.queryPageCondition.currentPage=l.currentPage,e.queryPageCondition.pageSize=l.pageSize,e.tableData=l.recordList}else e.$message.error(t.errorInfoList[0].errorMessage)})},queryTaskConfig:function(){var e=this;$.get(this.$baseUrl+"task/queryTaskConfig.json").then(function(t){"0000"==t.resultMessageEnum?(e.id=t.returnObject.id,u()(e.neoCallLimit).forEach(function(l){Object(m.isUndefined)(t.returnObject[l])||(t.returnObject[l]>=0?(e.neoCallLimit[l].select="custom",e.neoCallLimit[l].count=t.returnObject[l]):(e.neoCallLimit[l].select="unlimited",e.neoCallLimit[l].count=1))}),u()(e.releaseCycleForm).forEach(function(l){Object(m.isUndefined)(t.returnObject[l])||(t.returnObject[l]>0?(e.releaseCycleForm[l]="custom",e.releaseCycleCustom[l]=t.returnObject[l]):e.releaseCycleForm[l]=t.returnObject[l])})):e.$message.error(t.errorInfoList[0].errorMessage)})},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.queryPageCondition.pageSize=e,this.queryAntiHarassmentNumberList()},handleCurrentChange:function(e){console.log("当前页: "+e),this.queryPageCondition.currentPage=e,this.queryAntiHarassmentNumberList()},connectedResultFormatter:function(e,t,l,a){return 1==l?"接听":"未接听"},intentionLevelFormatter:function(e,t,l,a){switch(l){case 1:return"A";case 2:return"B";case 3:return"C";case 4:return"D";case 5:return"E";case 6:return"F";default:return""}},queryTaskResultRecognition:function(e,t){var l=this;this.taskItemResultRecognition=[];var a={taskItemId:t.taskItemId};$.get(this.$baseUrl+"task/queryTaskResultRecognition.json",$.param(a)).then(function(e){"0000"==e.resultMessageEnum?e.returnObject&&(l.viewVisible=!0,l.taskItemResultRecognition=e.returnObject,l.transferFlag=e.returnObject.transferFlag,setTimeout(function(){l.viewSource=e.returnObject.soundPath},200),e.returnObject.recognitionContent&&(l.viewTableData=JSON.parse(e.returnObject.recognitionContent))):l.$message.error(e.errorInfoList[0].errorMessage)})},search:function(){this.queryAntiHarassmentNumberList()},exportNumber:function(){var e=this,t=this.multipleSelection.map(function(e){return e.id});$.post(this.$baseUrl+"task/exportAntiHarassmentNumberListFile.json",i()(t)).then(function(t){"0000"==t.resultMessageEnum?e.downloadFile(t.returnObject.filePath):e.$message.error(t.errorInfoList[0].errorMessage)})},downloadFile:function(e){var t=e;window.location.href=this.$baseUrl+"file/downloadFile.html?filePath="+t},removeNumber:function(){if(0!=this.multipleSelection.length){for(var e=this,t=[],l=0;l<this.multipleSelection.length;l++)t.push(this.multipleSelection[l].id);$.ajax({url:this.$baseUrl+"task/removeAntiHarassmentNumbers.json",type:"POST",cache:!1,data:{numbers:t},dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"}}).done(function(t){"0000"==t.resultMessageEnum?(e.$message.success("操作成功！"),e.queryAntiHarassmentNumberList()):e.$message.error("操作失败！")}).fail(function(t){e.$message.error("操作失败！")})}else this.$message.error("请选择要移出的号码！")}},destroyed:function(){}},L={render:function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"table"},[l("div",{staticClass:"content-box-top"},[l("el-input",{staticClass:"handle-input mr10",attrs:{clearable:"",placeholder:"输入号码／用户名称／任务名称"},on:{change:function(e){}},model:{value:e.queryPageCondition.queryKey,callback:function(t){e.$set(e.queryPageCondition,"queryKey",t)},expression:"queryPageCondition.queryKey"}}),e._v(" "),l("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("搜索")]),e._v(" "),l("div",{staticClass:"content-box-top-right"},[l("el-button",{attrs:{type:"primary"},on:{click:e.handleHarass}},[e._v("防骚扰设置")])],1)],1),e._v(" "),l("div",{staticStyle:{position:"relative",left:"5px",top:"50px"}},[l("el-card",{staticClass:"box-card"},[l("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[l("span",[e._v("有效号码")]),e._v(" "),l("el-tooltip",{staticClass:"item",attrs:{effect:"light","popper-class":"speech-tip",placement:"right-start"}},[l("div",{attrs:{slot:"content"},slot:"content"},[e._v("\n            代表没有必要再打的情况，\n            "),l("br"),e._v("因此纳入防骚扰号码列表， "),l("br"),e._v("再规定时段内不再拨打\n          ")]),e._v(" "),l("i",{staticClass:"el-icon-question"})]),e._v(" "),l("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.removeNumber}},[e._v("移出")]),e._v(" "),l("el-button",{staticStyle:{float:"right","margin-right":"5px"},attrs:{type:"primary"},on:{click:e.exportNumber}},[e._v("导出")])],1),e._v(" "),l("div",{staticClass:"text item"},[l("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark"},on:{"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),l("el-table-column",{attrs:{prop:"phone",label:"号码",width:"120"}}),e._v(" "),l("el-table-column",{attrs:{prop:"taskName",label:"任务名称",width:"120"}}),e._v(" "),l("el-table-column",{attrs:{prop:"customerName",label:"用户姓名"}}),e._v(" "),l("el-table-column",{attrs:{prop:"callTime",label:"外呼时间",width:"120"}}),e._v(" "),l("el-table-column",{attrs:{prop:"connectedDuration",label:"通话时长",width:"120"}}),e._v(" "),l("el-table-column",{attrs:{prop:"connectedResultType",label:"通话结果",formatter:e.connectedResultFormatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"intentionLevel",label:"意向级别",width:"120",formatter:e.intentionLevelFormatter}}),e._v(" "),l("el-table-column",{attrs:{prop:"status",label:"状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",{class:1==t.row.status?"danger":"default"},[e._v(e._s(1==t.row.status?"限制中":"已移出"))])]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"识别详情",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{disabled:1!=t.row.connectedResultType,type:"text"},on:{click:function(l){return e.queryTaskResultRecognition(t.$index,t.row)}}},[e._v("查看")])]}}])})],1)],1),e._v(" "),l("div",{staticClass:"pagination"},[l("el-pagination",{attrs:{"current-page":e.queryPageCondition.currentPage,"page-sizes":[10,20,50,100,200],"page-size":e.queryPageCondition.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])],1),e._v(" "),l("el-dialog",{staticClass:"video-box",attrs:{title:"识别详情",visible:e.viewVisible,width:"600px"},on:{"update:visible":function(t){e.viewVisible=t}}},[l("div",{staticClass:"video-contant-box"},[l("w-video",{attrs:{source:e.viewSource,playing:e.viewPlaying}})],1),e._v(" "),l("el-table",{staticStyle:{width:"100%"},attrs:{data:e.viewTableData,stripe:""}},[l("el-table-column",{attrs:{prop:"nodeName",label:"节点名称",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("a",{staticClass:"viewItemText"},[e._v(e._s(t.row.nodeName))])]}}])}),e._v(" "),l("el-table-column",{attrs:{prop:"nodeContent",label:"识别内容"}})],1),e._v(" "),l("div",[1==e.transferFlag?l("el-tag",{attrs:{size:"medium"}},[l("i",{staticClass:"el-icon-service"}),e._v(" 后续通话转人工客服接待 ")]):e._e()],1)],1),e._v(" "),l("el-dialog",{attrs:{title:"防骚扰设置",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[l("el-tabs",{attrs:{value:"first"}},[l("el-tab-pane",{attrs:{label:"呼叫上限",name:"first"}},[l("el-form",{attrs:{model:e.neoCallLimit,"label-position":e.labelPosition,"label-width":"120px"}},[l("limit-input",{attrs:{label:"意图等级A"},model:{value:e.neoCallLimit.callLimitLevelA,callback:function(t){e.$set(e.neoCallLimit,"callLimitLevelA",t)},expression:"neoCallLimit.callLimitLevelA"}}),e._v(" "),l("limit-input",{attrs:{label:"意图等级B"},model:{value:e.neoCallLimit.callLimitLevelB,callback:function(t){e.$set(e.neoCallLimit,"callLimitLevelB",t)},expression:"neoCallLimit.callLimitLevelB"}}),e._v(" "),l("limit-input",{attrs:{label:"意图等级C"},model:{value:e.neoCallLimit.callLimitLevelC,callback:function(t){e.$set(e.neoCallLimit,"callLimitLevelC",t)},expression:"neoCallLimit.callLimitLevelC"}}),e._v(" "),l("limit-input",{attrs:{label:"意图等级D"},model:{value:e.neoCallLimit.callLimitLevelD,callback:function(t){e.$set(e.neoCallLimit,"callLimitLevelD",t)},expression:"neoCallLimit.callLimitLevelD"}}),e._v(" "),l("limit-input",{attrs:{label:"意图等级E"},model:{value:e.neoCallLimit.callLimitLevelE,callback:function(t){e.$set(e.neoCallLimit,"callLimitLevelE",t)},expression:"neoCallLimit.callLimitLevelE"}}),e._v(" "),l("limit-input",{attrs:{label:"意图等级F"},model:{value:e.neoCallLimit.callLimitLevelF,callback:function(t){e.$set(e.neoCallLimit,"callLimitLevelF",t)},expression:"neoCallLimit.callLimitLevelF"}}),e._v(" "),l("limit-input",{attrs:{label:"无意图等级"},model:{value:e.neoCallLimit.callLimitLevelO,callback:function(t){e.$set(e.neoCallLimit,"callLimitLevelO",t)},expression:"neoCallLimit.callLimitLevelO"}})],1)],1),e._v(" "),l("el-tab-pane",{attrs:{label:"释放周期",name:"second"}},[l("el-form",{attrs:{model:e.releaseCycle,"label-position":e.labelPosition,"label-width":"120px"}},e._l(e.releaseCycle,function(t,a){return l("el-form-item",{key:a,attrs:{label:t.title}},[l("el-select",{model:{value:e.releaseCycleForm[a],callback:function(t){e.$set(e.releaseCycleForm,a,t)},expression:"releaseCycleForm[name]"}},e._l(t.options,function(e){return l("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),"custom"==e.releaseCycleForm[a]?l("el-input-number",{attrs:{"controls-position":"right",min:1,max:1e3},model:{value:e.releaseCycleCustom[a],callback:function(t){e.$set(e.releaseCycleCustom,a,t)},expression:"releaseCycleCustom[name]"}}):e._e(),e._v("天\n          ")],1)}),1)],1)],1),e._v(" "),l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),l("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var g=l("VU/8")(C,L,!1,function(e){l("itYW")},"data-v-a2a00d1c",null);t.default=g.exports},itYW:function(e,t){},uuXw:function(e,t){}});