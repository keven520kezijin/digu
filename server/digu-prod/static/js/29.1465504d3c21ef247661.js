webpackJsonp([29],{"5u3u":function(e,t){},"Zf/7":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("mvHQ"),i=r.n(a),n={data:function(){return{ext:"ext",select_word:"",pagination:{show:!0,total:0,pageIndex:1,pageSize:20},cur_page:1,dataList:[],addNewEntry:!1,form:{name:""},form1:{file1:""},rules:{name:[{required:!0,message:"请输入词库名称",trigger:"blur"}]},rules1:{file1:[{required:!0,message:"请输选择文件",trigger:"blur"}]},multipleSelection:[],currentModifyOldLibraryName:"",canaleEvent:!1,confirmEvent:!1,delVisible:!1,libraryId:"",libraryName:"",batchUploadVisible:!1}},created:function(){this.libraryId=this.$route.params.id,this.libraryName=decodeURI(this.$route.params.libraryname),this.queryEntryList()},methods:{search:function(){this.cur_page=1,this.queryEntryList()},creatEntry:function(e){var t=this,r=!0;if(this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),r=!1,!1}),r){this.addNewEntry=!1;var a={entryName:this.form.name,libraryId:this.libraryId,libraryName:this.libraryName};$.post(this.$baseUrl+"sensitive/addWordEntry.json",i()(a)).then(function(e){"0000"==e.resultMessageEnum?(t.$message.success("新增成功！"),t.cur_page=1,t.queryEntryList()):t.$message.error(e.errorInfoList[0].errorMessage)})}},handleCurrentChange:function(e){this.cur_page=e,this.queryEntryList()},handleEditor:function(e,t){},queryEntryList:function(){var e=this,t={};t.currentPage=this.cur_page-1,t.pageSize=this.pagination.pageSize,t.libraryId=this.libraryId,""!=this.select_word&&(t.entryName=this.select_word),$.post(this.$baseUrl+"sensitive/queryWordEntryList.json",i()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.dataList=t.returnObject.recordList,e.pagination.total=t.returnObject.totalNumber):e.$message.error(t.errorInfoList[0].errorMessage)})},handleSelectionChange:function(e){this.multipleSelection=e},enterModify:function(e,t,r,a){if(this.canaleEvent||this.confirmEvent)return!1;this.resetLibrary();var i=e.id,n=i+"ext";if("el-table_1_column_2"==t.id){this.currentModifyOldLibraryName=e.entryName;var s=document.getElementById(i);document.getElementById(n).style.display="none",s.style.display="block"}},resetLibrary:function(){for(var e in this.dataList){var t=this.dataList[e].id,r=this.dataList[e].id+"ext",a=document.getElementById(t),i=document.getElementById(r);a.style.display="none",i.style.display="block"}},cancelChangeLibraryName:function(){this.resetLibrary()},confirmChangeLibraryName:function(e){var t=this;if(""!=this.currentModifyOldLibraryName)if(this.currentModifyOldLibraryName!=e.entryName){var r={entryName:this.currentModifyOldLibraryName,id:e.id};$.post(this.$baseUrl+"sensitive/modifyWordEntry.json",i()(r)).then(function(e){"0000"==e.resultMessageEnum?(t.$message.success("更新成功"),t.resetLibrary(),t.queryEntryList()):t.$message.error(e.errorInfoList[0].errorMessage)})}else this.resetLibrary();else this.$message.error("词条名称不能为空")},cancelChangeLibraryNameOver:function(){this.canaleEvent=!0},cancelChangeLibraryNameOut:function(){this.canaleEvent=!1},confirmChangeLibraryNameOut:function(){this.confirmEvent=!1},confirmChangeLibraryNameOver:function(){this.confirmEvent=!0},removeWordEntry:function(){var e=this,t=[];for(var r in this.multipleSelection)t.push(this.multipleSelection[r].id);$.post(this.$baseUrl+"sensitive/removeWordEntry.json",i()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.$message.success("删除成功"),e.delVisible=!1,e.queryEntryList()):e.$message.error(t.errorInfoList[0].errorMessage)})},batchUploadEntry:function(e){var t=$("#file1")[0].files,r=this,a=new FormData,i=r.libraryId;if(t.length<=0)return r.$message.error("没有选择任何文件"),!1;for(var n=0;n<t.length;n++){if(t[n].size>5242880)return this.$message.error("请选择5M以内的文件！"),this.changeFileType(),!1;if(".txt"!=t[n].name.substr(t[n].name.lastIndexOf(".")).toLowerCase())return r.$message.error("文件格式错误,重新选择！"),this.changeFileType(),!1;a.append("file",t[n])}a.append("libraryId",i),$.ajax({url:this.$baseUrl+"sensitive/batchUploadEntry.json",type:"POST",cache:!1,data:a,dataType:"json",headers:{"Content-Type":"multipart/form-data"},processData:!1,contentType:!1,async:!1}).done(function(e){"0000"==e.resultMessageEnum?(r.batchUploadVisible=!1,r.$message.success("批量上传成功"),r.queryEntryList()):r.$message.error("批量上传失败！")}).fail(function(e){})},changeFileType:function(){$("#file1").val("")}}},s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"table"},[r("div",{staticClass:"content-box-top"},[r("el-input",{staticClass:"handle-input mr10",attrs:{clearable:"",placeholder:"输入敏感词"},nativeOn:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.search(t):null}},model:{value:e.select_word,callback:function(t){e.select_word=t},expression:"select_word"}}),e._v(" "),r("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"search"},on:{click:e.search}},[e._v("搜索")])],1),e._v(" "),r("div",{staticStyle:{"padding-top":"75px"}}),e._v(" "),r("div",{staticStyle:{"padding-bottom":"10px",color:"#fdc83c","font-size":"large"}},[r("router-link",{attrs:{to:"/sensitive"}},[e._v("《返回词典列表")])],1),e._v(" "),r("div",{staticClass:"w-container"},[r("el-card",{staticClass:"box-card repository-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v(e._s(e.libraryName)+"词条列表")]),e._v(" "),r("div",{staticStyle:{float:"right"}},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.batchUploadVisible=!0}}},[e._v("批量上传")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addNewEntry=!0}}},[e._v("新增词条")]),e._v(" "),r("el-button",{attrs:{disabled:!e.multipleSelection.length,type:"primary"},on:{click:function(t){e.delVisible=!0}}},[e._v("删除词条")])],1)]),e._v(" "),r("div",{staticClass:"repository-box"},[r("div",[r("el-table",{attrs:{data:e.dataList},on:{"selection-change":e.handleSelectionChange,"cell-click":e.enterModify}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),r("el-table-column",{attrs:{label:"敏感词"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return t.$index,[r("span",{attrs:{id:a.id+e.ext}},[e._v(e._s(a.entryName))]),e._v(" "),r("span",{staticStyle:{display:"none"},attrs:{id:a.id}},[r("el-input",{staticStyle:{width:"200px"},model:{value:e.currentModifyOldLibraryName,callback:function(t){e.currentModifyOldLibraryName=t},expression:"currentModifyOldLibraryName"}}),e._v(" "),r("span",[r("el-button",{attrs:{type:"text",size:"small"},on:{click:e.cancelChangeLibraryName},nativeOn:{mouseout:function(t){return e.cancelChangeLibraryNameOut(t)},mouseover:function(t){return e.cancelChangeLibraryNameOver(t)}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmChangeLibraryName(a)}},nativeOn:{mouseout:function(t){return e.confirmChangeLibraryNameOut(t)},mouseover:function(t){return e.confirmChangeLibraryNameOver(t)}}},[e._v("确定")])],1)],1)]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"editor",label:"操作人"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text",disabled:""}},[e._v("编辑")])]}}])})],1)],1)]),e._v(" "),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:e.pagination.total,"page-size":e.pagination.pageSize},on:{"current-change":e.handleCurrentChange}})],1)]),e._v(" "),r("el-dialog",{attrs:{title:"新增敏感词",visible:e.addNewEntry,width:"30%"},on:{"update:visible":function(t){e.addNewEntry=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"label-width":"110px",rules:e.rules}},[r("el-form-item",{attrs:{label:"敏感词",prop:"name"}},[r("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addNewEntry=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.creatEntry("form")}}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"删除敏感词",visible:e.delVisible,width:"30%"},on:{"update:visible":function(t){e.delVisible=t}}},[r("span",[e._v("您确定已选中的"+e._s(e.multipleSelection.length)+"条敏感词吗？删除后将不能恢复")]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.removeWordEntry}},[e._v("确 定")])],1)]),e._v(" "),r("el-dialog",{attrs:{title:"批量上传敏感词",visible:e.batchUploadVisible,width:"30%"},on:{"update:visible":function(t){e.batchUploadVisible=t}}},[r("el-form",{ref:"form1",attrs:{model:e.form1,"label-width":"110px",rules:e.rules1}},[r("el-form-item",{attrs:{label:"选择本地文件",prop:"name"}},[r("el-input",{attrs:{type:"file",accept:"text/plain",name:"file1",id:"file1"},model:{value:e.form1.file1,callback:function(t){e.$set(e.form1,"file1",t)},expression:"form1.file1"}})],1)],1),e._v(" "),r("span",{staticStyle:{"font-size":"smaller",color:"red","padding-left":"110px"}},[e._v("注:批量导入的格式为TXT文件,每行一个敏感词,文件大小不超多5M")]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.batchUploadVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.batchUploadEntry}},[e._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var l=r("VU/8")(n,s,!1,function(e){r("5u3u")},"data-v-235ce048",null);t.default=l.exports}});