webpackJsonp([33],{"6gqD":function(e,t){},ogW7:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,s=r("bOdI"),i=r.n(s),a=r("mvHQ"),l=r.n(a),n={data:function(){return{dialogPublicGroupVisible:!1,publicKnoledgeName:"通用知识库",memberKnoledgeName:"用户知识库",resourceActiveName:"first",ypkActiveName:"ypkFirst",detailName:"通用知识库",type:1,searchForm:{groupName:"",memberIds:"",insdutry:"",allManager:!1},mangerSelectList:[],managerList:[],industryList:[],industryListaddQb:[],dialogAddKnoledgeVisible:!1,dialogDelGroupVisible:!1,addKnoledgeform:{name:"",industry:""},listOfPageData:[],pagination:{show:!0,total:0,pageIndex:1,pageSize:10},cur_page:1,selectdGroupList:[],publicDisabled:!1,selectdGroupCount:0,modifyGroupVisible:!1,modifyGroupForm:{},modifyGroupFormRules:{groupName:[{required:!0,message:"输入知识库名称",trigger:"blur"}]},searchUserKeyWord:"",curUserPage:1,tableMemberList:[],paginationUser:{show:!0,total:0,pageIndex:1,pageSize:10}}},created:function(){this.queryAllIndustryList(),this.getAllManager(),this.queryKnowledgeGroupListOfPage(),2==this.$route.params.type&&(this.ypkActiveName="ypkSecond",this.onUserSearch())},methods:(o={tabHandleClick:function(e){console.log(e)},ypkHandleClick:function(e){"ypkFirst"==e.name?this.detailName=this.publicKnoledgeName:"ypkSecond"==e.name&&(this.detailName=this.memberKnoledgeName,this.onUserSearch()),console.log(this.ypkActiveName)},onHandleReset:function(){this.searchForm.groupName="",this.searchForm.memberIds=[],this.searchForm.allManager=!1},onSearch:function(){this.queryKnowledgeGroupListOfPage()},getAllManager:function(){var e=this;$.get(this.$baseUrl+"services/manager/getManagerList.json").then(function(t){"0000"==t.resultMessageEnum&&t.returnObject&&t.returnObject.length&&(e.managerList=t.returnObject,console.log(e.managerList))})},queryAllIndustryList:function(){var e=this;$.get(this.$baseUrl+"services/intention/queryAllIndustryList.json").then(function(t){if("0000"==t.resultMessageEnum){if(t.returnObject&&t.returnObject.length)for(var r in e.industryList=t.returnObject,e.industryListaddQb.push({id:"DEL1",industryName:"行业领域"}),e.industryListaddQb.push({id:"DEL2",industryName:"全部"}),e.industryList)e.industryListaddQb.push(e.industryList[r])}else e.$message.error(t.errorInfoList[0].errorMessage)})},selectLY:function(e){for(var t in this.searchForm.insdutry="",this.industryListaddQb)t==e.index&&"DEL1"!=this.industryListaddQb[t].id&&"DEL2"!=this.industryListaddQb[t].id&&(this.searchForm.insdutry=this.industryListaddQb[t].id);this.cur_page=1,this.queryKnowledgeGroupListOfPage()},sortChange:function(e){console.log("sortChange",e)},handleSelectionChange:function(e){console.log("handleSelectionChange",e),this.selectdGroupList=e,e.length>0?this.publicDisabled=!0:this.publicDisabled=!1,this.selectdGroupCount=this.selectdGroupList.length},checkSelectable:function(e){console.log("checkSelectable",e)},addKnoledge:function(){var e=this,t=this.addKnoledgeform.name,r=this.addKnoledgeform.industry,o="";if(""!=t)if(""!=r){for(var s in this.industryList)this.industryList[s].id==r&&(o=this.industryList[s].industryName);var i={groupName:t,industryType:r,industryName:o,templateType:1};$.post(this.$baseUrl+"services/knowledge/addKnowledgeGroup.json?",l()(i)).then(function(t){"0000"==t.resultMessageEnum?(e.dialogAddKnoledgeVisible=!1,e.addKnoledgeform.industry="",e.addKnoledgeform.name="",e.queryKnowledgeGroupListOfPage()):e.$message.error(t.errorInfoList[0].errorMessage)})}else this.$message.error("请选择行业领域!");else this.$message.error("请输入知识库名称!")},queryKnowledgeGroupListOfPage:function(){var e=this,t={};t.currentPage=this.cur_page-1,t.pageSize=this.pagination.pageSize,t.templateType=1,t.searchType=this.searchForm.insdutry?"2":"0",this.searchForm.memberIds.length>0&&0==this.searchForm.allManager&&(t.memberIds=this.searchForm.memberIds),""!=this.searchForm.groupName&&(t.groupName=this.searchForm.groupName),""!=this.searchForm.insdutry&&(t.industryTypes=[this.searchForm.insdutry]),$.post(this.$baseUrl+"services/knowledge/queryKnowledgeGroupListOfPage.json?",l()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.listOfPageData=t.returnObject.recordList,e.pagination.total=t.returnObject.totalNumber):e.$message.error(t.errorInfoList[0].errorMessage)})},removeKnowledgeGroupList:function(){var e=this,t=[];for(var r in this.selectdGroupList)t.push(this.selectdGroupList[r].id);$.post(this.$baseUrl+"services/knowledge/removeKnowledgeGroupList.json?",l()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.dialogDelGroupVisible=!1,e.queryKnowledgeGroupListOfPage(),e.$message.success("已删除"+e.selectdGroupCount+"个知识库！")):e.$message.error(t.errorInfoList[0].errorMessage)})}},i()(o,"checkSelectable",function(e,t){return this.selectable}),i()(o,"handleCurrentChange",function(e){this.cur_page=e,this.queryKnowledgeGroupListOfPage()}),i()(o,"industryRowClick",function(e,t,r){console.log(e,t,r)}),i()(o,"handleModifyGroup",function(e,t){this.modifyGroupForm.groupName=t.groupName,this.modifyGroupForm.id=t.id,this.modifyGroupVisible=!0}),i()(o,"modifyKnowledgeGroup",function(){var e=this,t={groupName:this.modifyGroupForm.groupName,id:this.modifyGroupForm.id};this.$refs.modifyGroupForm.validate(function(r){$.post(e.$baseUrl+"services/knowledge/modifyKnowledgeGroup.json?",l()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.modifyGroupVisible=!1,e.queryKnowledgeGroupListOfPage()):e.$message.error(t.errorInfoList[0].errorMessage)})})}),i()(o,"handleConfig",function(e,t){console.log(e,t),this.$router.push("/repository/config/"+t.id)}),i()(o,"publishKnowledgeGroup",function(e,t){var r=this;t.id;$.post(this.$baseUrl+"services/knowledge/publishKnowledgeGroup.json?groupId="+t.id).then(function(t){"0000"==t.resultMessageEnum?(r.listOfPageData[e].itemUpdateFlag=0,r.$message.success("发布成功")):r.$message.error(t.errorInfoList[0].errorMessage)})}),i()(o,"publishKnowledgeGroupAll",function(){var e=this,t=[];for(var r in this.selectdGroupList)t.push(this.selectdGroupList[r].id);$.post(this.$baseUrl+"services/knowledge/publishKnowledgeGroupBatch.json?",l()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.dialogPublicGroupVisible=!1,e.queryKnowledgeGroupListOfPage(),e.$message.success("发布成功")):e.$message.error(t.errorInfoList[0].errorMessage)})}),i()(o,"onUserSearch",function(){var e=this;console.log(this.searchUserKeyWord);var t={currentPage:this.curUserPage-1,pageSize:this.pagination.pageSize};""!=this.searchUserKeyWord&&(t.queryKey=this.searchUserKeyWord),$.post(this.$baseUrl+"services/member/queryMemberList.json",l()(t)).then(function(t){"0000"==t.resultMessageEnum?(e.tableMemberList=t.returnObject.recordList,e.paginationUser.total=t.returnObject.totalNumber):e.$message.error(t.errorInfoList[0].errorMessage)})}),i()(o,"handleUserCurrentChange",function(e){this.curUserPage=e,this.onUserSearch()}),i()(o,"lookUserGroup",function(e,t){console.log(e,t),this.$router.push("/repositoryusergroup/"+t.memberId)}),o)},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"container-admin"},[r("div",{staticClass:"admin-page"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",[e._v("管理中心")]),e._v(" "),r("el-breadcrumb-item",[e._v("知识库管理")]),e._v(" "),r("el-breadcrumb-item",[e._v(e._s(e.detailName))])],1),e._v(" "),r("keep-alive",[r("el-tabs",{on:{"tab-click":e.tabHandleClick},model:{value:e.resourceActiveName,callback:function(t){e.resourceActiveName=t},expression:"resourceActiveName"}},[r("el-tab-pane",{attrs:{label:"知识库",name:"first"}})],1)],1)],1),e._v(" "),r("div",{staticClass:"admin-body"},[r("el-tabs",{on:{"tab-click":e.ypkHandleClick},model:{value:e.ypkActiveName,callback:function(t){e.ypkActiveName=t},expression:"ypkActiveName"}},[r("el-tab-pane",{attrs:{label:"通用知识库",name:"ypkFirst"}}),e._v(" "),r("el-tab-pane",{attrs:{label:"用户知识库",name:"ypkSecond"}})],1),e._v(" "),"ypkFirst"==this.ypkActiveName?r("el-row",{staticClass:"first-row"},[r("el-col",[r("el-form",{staticClass:"w-form-inline",attrs:{inline:!0}},[r("el-form-item",{attrs:{label:"关键词："}},[r("el-input",{attrs:{clearable:"",placeholder:"知识库名称"},nativeOn:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.onSearch(t):null}},model:{value:e.searchForm.groupName,callback:function(t){e.$set(e.searchForm,"groupName",t)},expression:"searchForm.groupName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"操作人："}},[r("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:e.searchForm.memberIds,callback:function(t){e.$set(e.searchForm,"memberIds",t)},expression:"searchForm.memberIds"}},e._l(e.managerList,function(e){return r("el-option",{key:e.id,attrs:{label:e.loginName,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",[r("el-checkbox",{model:{value:e.searchForm.allManager,callback:function(t){e.$set(e.searchForm,"allManager",t)},expression:"searchForm.allManager"}},[e._v("全部")])],1),e._v(" "),r("el-form-item",[r("el-button",{on:{click:e.onHandleReset}},[e._v("重置")])],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.onSearch}},[e._v("搜索")])],1)],1)],1),e._v(" "),r("el-col",[r("el-button",{attrs:{disabled:0==this.publicDisabled},on:{click:function(t){e.dialogDelGroupVisible=!0}}},[e._v("删除")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogAddKnoledgeVisible=!0}}},[e._v("新增")]),e._v(" "),r("div",{staticStyle:{float:"right"}},[r("el-button",{attrs:{type:"primary",disabled:0==this.publicDisabled},on:{click:function(t){e.dialogPublicGroupVisible=!0}}},[e._v("发布")])],1)],1)],1):e._e(),e._v(" "),"ypkFirst"==this.ypkActiveName?r("el-row",[r("el-col",{staticClass:"repository-menu-box",attrs:{span:24}},[r("el-tabs",{attrs:{"tab-position":"left"},on:{"tab-click":e.selectLY}},e._l(e.industryListaddQb,function(t){return r("el-tab-pane",{key:t.id,attrs:{label:t.industryName}},[r("el-col",[r("el-table",{attrs:{stripe:"",data:e.listOfPageData},on:{"sort-change":e.sortChange,"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),r("el-table-column",{attrs:{label:"知识库名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.itemUpdateFlag?r("span",{staticStyle:{color:"#ad7f48"}},[e._v("[待发布]")]):e._e(),e._v(" "),r("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.groupName))])]}}],null,!0)}),e._v(" "),r("el-table-column",{attrs:{width:"250",sortable:"",prop:"editTime",label:"更新时间"}}),e._v(" "),r("el-table-column",{attrs:{prop:"editor",label:"操作人"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.handleModifyGroup(t.$index,t.row)}}},[e._v("修改名称")]),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.handleConfig(t.$index,t.row)}}},[e._v("配置")]),e._v(" "),1==t.row.itemUpdateFlag?r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.publishKnowledgeGroup(t.$index,t.row)}}},[e._v("发布")]):r("el-button",{attrs:{type:"text",disabled:""}},[e._v("发布")])]}}],null,!0)})],1),e._v(" "),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:e.pagination.total,"page-size":e.pagination.pageSize},on:{"current-change":e.handleCurrentChange}})],1)],1)],1)}),1)],1)],1):e._e(),e._v(" "),"ypkSecond"==this.ypkActiveName?r("el-row",[r("el-col",[r("el-form",{staticClass:"w-form-inline",attrs:{inline:!0}},[r("el-form-item",{attrs:{label:"关键词："}},[r("el-input",{attrs:{clearable:"",placeholder:"用户名称"},nativeOn:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.onUserSearch(t):null}},model:{value:e.searchUserKeyWord,callback:function(t){e.searchUserKeyWord=t},expression:"searchUserKeyWord"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.onUserSearch}},[e._v("搜索")])],1)],1)],1),e._v(" "),r("el-col",[r("el-table",{attrs:{data:e.tableMemberList}},[r("el-table-column",{attrs:{prop:"enterpriseName",label:"创建用户"}}),e._v(" "),r("el-table-column",{attrs:{prop:"editTime",sortable:"",label:"更新时间"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.lookUserGroup(t.$index,t.row)}}},[e._v("查看")])]}}],null,!1,825630628)})],1),e._v(" "),r("div",{staticClass:"pagination"},[r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next,jumper",total:e.paginationUser.total,"page-size":e.paginationUser.pageSize},on:{"current-change":e.handleUserCurrentChange}})],1)],1)],1):e._e()],1),e._v(" "),r("el-dialog",{attrs:{title:"新增知识库",visible:e.dialogAddKnoledgeVisible},on:{"update:visible":function(t){e.dialogAddKnoledgeVisible=t}}},[r("el-form",[r("el-form-item",{attrs:{label:"知识库名称","label-width":"150px"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.addKnoledgeform.name,callback:function(t){e.$set(e.addKnoledgeform,"name",t)},expression:"addKnoledgeform.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"行业领域","label-width":"150px"}},[r("el-select",{attrs:{placeholder:"请选择"},model:{value:e.addKnoledgeform.industry,callback:function(t){e.$set(e.addKnoledgeform,"industry",t)},expression:"addKnoledgeform.industry"}},e._l(e.industryList,function(e){return r("el-option",{key:e.id,attrs:{label:e.industryName,value:e.id}})}),1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogAddKnoledgeVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addKnoledge}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"删除知识库",visible:e.dialogDelGroupVisible,width:"25%"},on:{"update:visible":function(t){e.dialogDelGroupVisible=t}}},[r("span",[e._v("您确定要删除选中的"+e._s(e.selectdGroupCount)+"个知识库吗？删除后将不能恢复")]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogDelGroupVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.removeKnowledgeGroupList}},[e._v("确 定")])],1)]),e._v(" "),r("el-dialog",{staticClass:"creat-faq-dialog",attrs:{title:"修改名称",visible:e.modifyGroupVisible,width:"600px"},on:{"update:visible":function(t){e.modifyGroupVisible=t}}},[r("el-form",{ref:"modifyGroupForm",attrs:{model:e.modifyGroupForm,"label-width":"114px",rules:e.modifyGroupFormRules}},[r("el-form-item",{attrs:{label:"知识库名称",prop:"groupName"}},[r("el-input",{attrs:{placeholder:"输入知识库名称"},model:{value:e.modifyGroupForm.groupName,callback:function(t){e.$set(e.modifyGroupForm,"groupName",t)},expression:"modifyGroupForm.groupName"}})],1)],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.modifyGroupVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.modifyKnowledgeGroup}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"发布知识库",visible:e.dialogPublicGroupVisible,width:"25%"},on:{"update:visible":function(t){e.dialogPublicGroupVisible=t}}},[r("span",[e._v("您确定要发布所有更新的知识库吗？")]),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogPublicGroupVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.publishKnowledgeGroupAll}},[e._v("确 定")])],1)])],1)},staticRenderFns:[]};var d=r("VU/8")(n,u,!1,function(e){r("6gqD")},"data-v-033baff2",null);t.default=d.exports}});